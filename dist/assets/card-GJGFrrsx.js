import{r as d,g as m,u as f,i as o,j as e,k as j,l as p,m as v,n as g,e as w,o as N}from"./index-CeB6bKrg.js";import{S as y}from"./hoc-_X8yIL5-.js";import{R as b}from"./rateHandler-78g094yH.js";var u=function(){var t=document.createDocumentFragment(),s=document.createElement("canvas");return t.appendChild(s),s.getContext("2d")},_=function(t,s){var l=u();if(l.font=s,Array.isArray(t))return Math.max.apply(Math,t.map(function(a){return l.measureText(a).width}));var i=l.measureText(t);return i.width},C=function(t){var s=d.useMemo(function(){return"text"in t?t:void 0},[t]),l=d.useMemo(function(){return"ref"in t?t:void 0},[t]);return d.useMemo(function(){var i,a;if(!((i=l==null?void 0:l.ref.current)===null||i===void 0)&&i.textContent){var n=u(),c=window.getComputedStyle(l.ref.current);n.font=c.font;var x=n.measureText(l.ref.current.textContent);return x.width}else if(s!=null&&s.text)return _(s.text,(a=s.font)!==null&&a!==void 0?a:"16px times");return NaN},[s==null?void 0:s.text,s==null?void 0:s.font,l==null?void 0:l.ref])};const q=async(t,s)=>{await m.post("http://127.0.0.1:8000/products",{id:s.id,img:s.img,title:s.title,isAvailable:s.isAvailable,remaining:s.remaining,rate:s.rate,price:s.price,discountPrecent:s.discountPrecent,quantity:s.isAvailable?t?t.quantity<9?t.quantity+1:t.quantity:1:0}).then(()=>{console.log("posted succesfuly")}).catch(l=>{console.log(l)})},W=({product:t})=>{const s=f(),l=o(n=>n.data),i=C({text:t.title}),a=n=>{const c=l.cards.find(x=>x.id==n.id);s(j(n)),q(c,n)};return e.jsxs("div",{className:"flex bg-g_Text_White h-[130px] w-[250px] py-1 overflow-hidden",children:[e.jsx("div",{className:"flex w-[7rem]",children:e.jsx("img",{src:t.img,alt:"",className:"w-full h-full"})}),e.jsxs("div",{className:"flex flex-col justify-center items-start w-[133px]",children:[e.jsxs("div",{style:{width:`${i}px`},className:"flex justify-start overflow-hidden",children:[e.jsx("div",{className:"flex justify-start w-[111px] text-right overflow-hidden",children:e.jsx("p",{className:"flex min-w-max text-right overflow-hidden",children:t.title})}),e.jsx("p",{children:"..."})]}),e.jsxs("span",{className:"flex w-full justify-start",children:[t.price-t.price*t.discountPrecent/100,e.jsx("small",{children:"تومان"})]}),e.jsxs("div",{style:{direction:"initial"},className:"flex items-center relative w-full h-[16px] ",children:[e.jsx(b,{product:t}),e.jsxs("small",{children:["(",t.rateCount,")"]}),e.jsx("small",{children:t.rate})]}),e.jsx("button",{onClick:()=>a(t),className:"bg-red-400 py-1 px-3 text-[.7rem] mt-2 rounded-[10px] text-g_Text_White",children:"افزودن به سبد خرید"})]})]})},A=async t=>{await m.delete(`http://127.0.0.1:8000/products/${t.id}`)},P=async t=>{await m.patch(`http://127.0.0.1:8000/products/${t.id}`,{quantity:t.value}).then(s=>{console.log(s)}).catch(s=>{console.log(s)})},S=({product:t})=>{const s=f(),i=o(r=>r.data).cards.find(r=>t.id==r.id),[a,n]=d.useState(i.quantity);d.useEffect(()=>{n(i.quantity)},[i]);const c=r=>{A(r),s(p(r))},x=r=>{const h=r.target.value;s(v({...t,quantity:Number(h)})),n(h),P(t)};return e.jsxs("div",{className:"flex flex-col bg-g_Text_White w-full h-fit",children:[e.jsxs("div",{className:"flex md:flex-row flex-col",children:[e.jsx("div",{className:"flex items-center justify-center md:w-[12rem] w-full",children:e.jsx("img",{src:t.img,alt:"",className:"object-contain md:w-[12rem] w-[8rem] h-full"})}),e.jsxs("div",{className:"flex flex-col justify-between text-right p-4",children:[e.jsxs("div",{className:"flex flex-col items-start gap-1",children:[e.jsx("p",{children:t.title}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("span",{className:"flex flex-row gap-1",children:["قیمت:",t.price,e.jsx("small",{children:"تومان"})]}),t.discountPrecent!==0&&e.jsxs("span",{className:"flex py-[1px] px-[5px] text-[.9rem] bg-red-600 rounded-full text-white",children:[t.discountPrecent,"%"]})]}),e.jsxs("div",{className:"flex flex-col text-[.8rem]",children:[e.jsxs("div",{className:"flex gap-2 justify-start",children:[e.jsx("input",{id:`gift${t.id}`,type:"checkbox"}),e.jsx("label",{htmlFor:`gift${t.id}`,className:"pb-1",children:"این یک هدیه است"})]}),e.jsxs("div",{className:"flex flex-row gap-1",children:[t.isAvailable?e.jsx("span",{className:"flex w-fit text-[.7rem] text-green-600",children:"موجود"}):e.jsx("span",{className:"flex w-fit font-[500] text-red-600",children:"نا موجود"}),t.remaining?e.jsxs("div",{className:"flex gap-1 pt-[.1rem] text-red-600 -mt-[.2rem]",children:[t.remaining,"_ عدد در انبار باقی مانده"]}):""]}),e.jsx("span",{children:"رنگ"}),e.jsx("span",{children:"حالت"}),e.jsx("span",{children:"نوع"})]})]}),e.jsxs("div",{className:"flex flex-row flex-wrap items-center pt-2",children:[e.jsxs("div",{className:"relative flex items-center justify-center ",children:[e.jsx("select",{style:{direction:"initial"},id:t.id,name:"تعداد",value:a,onChange:r=>x(r),className:"flex w-[73px] h-[30px] px-1 pb-1 rounded-[15px] bg-transparent shadow-3xl z-10",children:t.isAvailable?e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"1",children:"1"}),e.jsx("option",{value:"2",children:"2"}),e.jsx("option",{value:"3",children:"3"}),e.jsx("option",{value:"4",children:"4"}),e.jsx("option",{value:"5",children:"5"}),e.jsx("option",{value:"6",children:"6"}),e.jsx("option",{value:"7",children:"7"}),e.jsx("option",{value:"8",children:"8"}),e.jsx("option",{value:"9",children:"9"})]}):e.jsx("option",{value:"0",children:"0"})}),e.jsx("label",{style:{direction:"initial"},onClick:()=>document.getElementById(t.id).click(),htmlFor:t.id,className:"absolute left-0 top-0 flex items-center justify-center font-[500] text-[.8rem] w-[73px] h-[30px] px-1 pb-1 rounded-[15px] bg-g_Background_White_Shop shadow-3xl",children:": تعداد"})]}),e.jsx("button",{onClick:()=>c(t),className:"border-l-[1px] px-4 h-6 min-w-max font-[400] text-[.8rem]",children:"حذف"}),e.jsx("button",{className:"border-l-[1px] px-4 h-6 min-w-max font-[400] text-[.8rem]",children:"ذخیره برای بعد"}),e.jsx("button",{className:"border-l-[1px] px-4 h-6 min-w-max font-[400] text-[.8rem]",children:"مقایسه با محصولات مشابه"}),e.jsx("button",{className:"border-l-[1px] px-4 h-6 min-w-max font-[400] text-[.8rem]",children:"به اشتراک گذاشتن"})]})]})]}),t.isAvailable?e.jsxs("div",{className:"flex justify-start w-full pb-4 pt-1 pr-4 border-t-2",children:["هزینه کل : ",(t.price-t.price*t.discountPrecent/100)*t.quantity," تومان"]}):e.jsx("div",{className:"flex justify-start w-full pb-4 pt-1 pr-4 border-t-2",children:"موجود شد اطلاع بده"})]})},T=async()=>{await m.delete("http://127.0.0.1:8000/products/all")},k=()=>{const t=f(),s=o(a=>a.data),l=o(a=>a.loading),i=()=>{T(),t(N())};return e.jsx("section",{className:"flex items-center justify-center w-screen",children:e.jsxs("div",{className:"flex md:flex-row flex-col justify-center gap-4 w-full max-w-[1450px]",children:[e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("div",{className:"flex justify-start w-full bg-g_Text_White border-b-[1px] border-g_Border_Shaded_Shop text-2xl p-4",children:"سبد خرید"}),e.jsxs("div",{children:[s.cards&&s.cards.map((a,n)=>e.jsx(S,{product:a})),l.cardLoading&&e.jsx("div",{className:"flex items-center justify-center w-full h-10",children:e.jsx(g,{})})]}),e.jsx("div",{className:"flex w-full justify-start",children:s.cards.length>0&&e.jsx("button",{onClick:()=>i(),className:"flex items-center justify-center bg-gray-400 text-g_Text_White py-2 px-12 w-fit mt-4 rounded-[2rem]",children:"حذف همه"})})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center md:w-[250px] h-[125px] p-2 bg-g_Text_White gap-4",children:[e.jsx("div",{className:"flex gap-1",children:e.jsxs("span",{className:"flex flex-row",children:[e.jsx("p",{children:"هزینه کل"}),"(",s.totalitems,e.jsx("p",{children:"مورد"}),"):",s.totalprice,e.jsx("p",{className:"text-[.6rem]",children:"تومان"})]})}),e.jsx("button",{className:"w-full pt-1 pb-2 rounded-full bg-red-400 text-g_Text_White font-[500]",children:"پرداخت صورت حساب"})]}),e.jsx("div",{className:"flex md:flex-col flex-wrap items-center justify-around md:[&>*:nth-child(1)]:rounded-t-[1rem] gap-y-2",children:w.map((a,n)=>e.jsx(W,{product:a}))})]})]})})},D=y(k,"card");export{D as default};
