import{O as X,r as o,u as P,i as k,j as e,z as _,Q as Y,S as Z,_ as $,H as J,U as M,V as E,W as G,X as R,g as L,Y as K,Z as U,$ as ee,a0 as te,a1 as se,a2 as le,a3 as ae,a4 as ne,a5 as ie,a6 as re,a7 as ce,a8 as oe,a9 as de,aa as me,ab as ue}from"./index-44z4Ba-6.js";import{b as xe}from"./index.esm-nrpjNvWf.js";import{G as fe}from"./index.esm-tB1KolLj.js";function he(t){return X({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#E65100",d:"M41,42H13c-2.2,0-4-1.8-4-4V18c0-2.2,1.8-4,4-4h28c2.2,0,4,1.8,4,4v20C45,40.2,43.2,42,41,42z"}},{tag:"path",attr:{fill:"#F57C00",d:"M35,36H7c-2.2,0-4-1.8-4-4V12c0-2.2,1.8-4,4-4h28c2.2,0,4,1.8,4,4v20C39,34.2,37.2,36,35,36z"}},{tag:"circle",attr:{fill:"#FFF9C4",cx:"30",cy:"16",r:"3"}},{tag:"polygon",attr:{fill:"#942A09",points:"17,17.9 8,31 26,31"}},{tag:"polygon",attr:{fill:"#BF360C",points:"28,23.5 22,31 34,31"}}]})(t)}const $e=()=>{const[t,s]=o.useState(""),[a,l]=o.useState(""),i=P(),p=o.useRef(),c=k(r=>r.ui).loginUser;o.useEffect(()=>{function r(){const m=new URL(Object.assign({"../../assets/avatar/testImg.png":$})[`../../assets/avatar/${c&&c[0].avatar}`],import.meta.url).href,f=m.split("/").length,j=m.split("/")[f-1];j!=="undefined"&&s(m),j=="undefined"&&s(null)}r()},[c]);const n=r=>{r.preventDefault();const m="https://saeedwebdev.ir/i",f=c[0].id,j=p.current.text.value,C=0,F=new FormData;F.append("image",a);const N="https://saeedwebdev.ir/api/posts";async function S(){if(a){const v=await J(m,F);if(v){const w=v&&await M(N,f,j,v,C);if(w){i(E(w));const y=await G(N);i(R(y))}}}if(!a){const w=await M(N,f,j,"",C);if(w){i(E(w));const y=await G(N);i(R(y)),setImageAdrress(null)}}}S()};return e.jsx("form",{enctype:"multipart/form-data",onSubmit:r=>n(r),ref:p,className:"flex justify-center w-full",children:e.jsxs("div",{className:"flex flex-col items-center justify-center w-full shadow-3xl rounded-[.6rem] max-w-[800px] bg-white",children:[e.jsxs("div",{className:"flex w-full md:p-4 px-[5%] py-2 md:gap-2 gap-1",children:[e.jsx("label",{htmlFor:"text",className:"md:max-w-[50px] max-w-[40px] md:h-[50px] h-[40px] bg-white rounded-full",children:e.jsx("img",{src:t||_,className:"md:max-w-[50px] max-w-[40px] md:h-[50px] h-[40px] object-cover rounded-full"})}),e.jsx("input",{type:"text",name:"text",id:"text",placeholder:"به چه چیری فکر میکنید ؟",className:"w-full pr-2 md:text-[1rem] text-[.9rem]"})]}),e.jsx("div",{className:"flex items-center justify-center w-full md:px-10 px-[5%]",children:e.jsxs("div",{className:"flex items-center justify-between w-full border-t-[2px] py-4 ",children:[e.jsxs("div",{className:"flex w-full md:gap-5 gap-2 [&>div>label]:flex [&>div>label]:gap-1 [&>div>input]:hidden [&>div>label>span]:flex [&>div>label>span]:items-center md:[&>div>label>span]:text-[1.1rem] [&>div>label>span]:text-clamp1 [&>div>label>span]:text-orange-600",children:[e.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[e.jsxs("label",{htmlFor:"image",children:[e.jsx("span",{children:e.jsx(he,{})}),e.jsx("span",{children:"فیلم و عکس"})]}),e.jsx("input",{onChange:r=>l(r.target.files[0]),type:"file",name:"image",id:"image",accept:".jpg, .jpeg, .png"})]}),e.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[e.jsxs("label",{htmlFor:"location",children:[e.jsx("span",{children:e.jsx(Y,{})}),e.jsx("span",{children:"مکان"})]}),e.jsx("input",{type:"location",name:"location",id:"location"})]}),e.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[e.jsxs("label",{children:[e.jsx("span",{children:e.jsx(Z,{})}),e.jsx("span",{children:"ها تگ"})]}),e.jsx("input",{type:"file",name:"image",id:"image"})]})]}),e.jsx("div",{className:"flex justify-end w-[30%]",children:e.jsx("div",{className:"bg-green-500 hover:bg-green-600 rounded-[.4rem] text-white font-semibold",children:e.jsx("input",{type:"submit",name:"submit",value:"اشتراک",className:"cursor-pointer md:py-2 py-[.4rem] md:px-4 px-[.7rem] md:text-[1rem] text-[.9rem]"})})})]})})]})})},I=t=>L.get(t).then(({data:s})=>s).catch(s=>{console.log(s)}),pe=(t,s,a)=>L.post(t,{post_id:s,user_id:a}).then(({data:l})=>l).catch(l=>{console.log(l)}),je=t=>L.delete(t).then(({data:s})=>(console.log(s),s)).catch(s=>{console.log(s)}),D=t=>L.get(t).then(({data:s})=>s).catch(s=>{console.log(s)}),be=(t,s,a,l)=>L.post(t,{text:s,post_id:a,user_id:l}).then(({data:i})=>(console.log("data"),console.log(i),i)).catch(i=>{console.log(i)}),ge=({comment:t,loginUser:s,targetUser:a})=>{const[l,i]=o.useState(null),c=k(n=>n.ui).allLoginUsers.find(n=>n.id==t.user_id);return o.useEffect(()=>{function n(){const r=new URL(Object.assign({"../../../assets/avatar/testImg.png":$})[`../../../assets/avatar/${a&&a.avatar}`],import.meta.url).href,m=r.split("/").length,f=r.split("/")[m-1];f!=="undefined"&&i(r),f=="undefined"&&i(null)}n()},[a]),e.jsxs("div",{className:`flex ${t.user_id==s[0].id?"justify-end":"justify-start gap-2"} min-w-max`,children:[t.user_id!==s[0].id?e.jsx("div",{className:"w-[40px] h-[40px] ",children:e.jsx("img",{src:l||_,alt:"",className:"object-cover h-full w-full rounded-full"})}):e.jsx(e.Fragment,{}),e.jsxs("p",{className:`relative max-w-[22rem] px-3 py-2 rounded-[1.5rem] break-words ${t.user_id==s[0].id?"bg-blue-700 text-left text-white":"bg-gray-300"} overflow-visible`,children:[t.user_id==s[0].id&&e.jsx("span",{className:"absolute left-0 -top-4 text-black text-[.7rem] min-w-max",children:s[0]&&s[0].firstName+" "+s[0].lastName}),t.user_id!==s[0].id&&e.jsx("span",{className:"absolute right-3 -top-4 text-black text-[.7rem] min-w-max",children:c&&c.firstName+" "+c.lastName}),t.text]})]})},ve=({post:t})=>{const s=o.useRef(),[a,l]=o.useState(""),i=P(),d=k(n=>n.ui).loginUser,c=n=>{n.preventDefault(),l("");const r=s.current.text.value,m="https://saeedwebdev.ir/api/comments";async function f(){const j=await be(m,r,t.id,d[0].id);j&&i(te(j))}f()};return e.jsxs("form",{onSubmit:n=>c(n),ref:s,className:"relative flex items-center justify-center border-[2px] w-full h-11 rounded-full",children:[e.jsx("input",{onChange:n=>l(n.target.value),value:a,type:"text",name:"text",placeholder:"پیام ...",className:"h-full w-full rounded-full px-12"}),a?e.jsxs("div",{className:"absolute right-3 text-[1.5rem] text-blue-600",children:[e.jsx("label",{htmlFor:"submit",children:e.jsx(K,{})}),e.jsx("input",{type:"submit",id:"submit",className:"hidden"})]}):e.jsx("i",{className:"absolute right-3 text-[1.5rem]",children:e.jsx(U,{})}),e.jsxs("div",{className:"absolute left-6 flex text-[1.5rem] gap-4",children:[e.jsx("i",{children:e.jsx(ee,{})}),e.jsx("i",{children:e.jsx(fe,{})})]})]})},we=({post:t,targetUser:s})=>{const a=k(d=>d.ui),l=a.allPostComments,i=a.loginUser,p=P();return o.useEffect(()=>{const d=`https://saeedwebdev.ir/api/comments/${t.id}`;async function c(){const n=await D(d);n&&p(se(n))}c()},[]),e.jsx("div",{className:"relative flex items-start w-full h-full px-4",children:e.jsxs("div",{className:"sticky top-0 flex flex-col items-start justify-between w-full h-full border-t-2",children:[e.jsx("div",{className:"flex flex-col w-full gap-3 pt-4",children:l[0]?l.map(d=>e.jsx(ge,{comment:d,loginUser:i,targetUser:s})):e.jsx("div",{className:"flex items-center justify-center font-medium",children:"هیچ نظری وجود ندارد"})}),e.jsx("div",{className:"sticky bottom-0 flex items-center justify-center w-full bg-bg-theme-body py-3",children:e.jsx(ve,{post:t})})]})})},Ne=({post:t,handleSetComment:s,targetUser:a})=>e.jsx("div",{className:"fixed top-0 bottom-0 left-0 right-0 flex items-center justify-center bg-gray-400/25 z-50 py-4 px-10 ",children:e.jsxs("div",{className:"flex flex-col w-full h-full max-h-[800px] max-w-[700px] bg-white overflow-y-scroll rounded-[.6rem]",children:[e.jsxs("header",{className:"sticky top-0 bg-white flex justify-center items-center w-full px-4 min-h-[70px] text-[1.3rem] gap-3 z-50 border-b-[1px]",children:[e.jsx("h1",{children:a&&a.firstName+" "+a.lastName}),e.jsx("div",{className:"absolute left-4",children:e.jsxs("button",{onClick:s,className:"relative flex items-center justify-center font-normal w-10 h-10 bg-gray-300 rounded-full hover:bg-bg-hover",children:[e.jsx("i",{className:"absolute w-[.1rem] h-5 rotate-45 bg-black"}),e.jsx("i",{className:"absolute w-5 h-[.1rem] rotate-45 bg-black"})]})})]}),e.jsx("div",{children:e.jsx(Ce,{post:t,edition:"comment",handleSetCommentCall:s})}),e.jsx("div",{className:"h-full bg-bg-theme-body",children:e.jsx(we,{post:t,targetUser:a})})]})}),ye=()=>{},ke=({handleNotIntrest:t})=>e.jsx("div",{className:"fixed top-0 left-0 flex items-center justify-center w-screen h-screen bg-gray-700/50 z-50",children:e.jsxs("div",{className:"flex flex-col items-center justify-between w-[20rem] border-t-2 border-x-2 bg-white rounded-[1rem] [&>*:last-child]:rounded-b-[1rem] [&>*]:flex [&>*]:justify-center [&>*]:items-center [&>*]:w-full [&>*]:p-2 [&>*]:h-[48px] [&>*]:border-b-2 [&>*]:cursor-pointer",children:[e.jsx("button",{children:"Report"}),e.jsx("button",{children:"Add favorites"}),e.jsx("button",{children:"Go to posts"}),e.jsx("button",{children:"About this acount"}),e.jsx("button",{onClick:t,children:"Cancel"})]})}),Ce=({post:t,edition:s,handleSetCommentCall:a,targetUser:l})=>{const[i,p]=o.useState(null),[d,c]=o.useState(null),[n,r]=o.useState(!1),[m,f]=o.useState(!1),[j,C]=o.useState(!1),[F,N]=o.useState(""),[S,v]=o.useState(null),[w,y]=o.useState(null),O=P(),b=k(u=>u.ui).loginUser;o.useEffect(()=>{function u(){const h=new URL(Object.assign({"../../assets/avatar/testImg.png":$})[`../../assets/avatar/${l&&l.avatar}`],import.meta.url).href,x=h.split("/").length,A=h.split("/")[x-1];A!=="undefined"&&c(h),A=="undefined"&&c(null);const g=new URL(Object.assign({"../../assets/avatar/testImg.png":$})[`../../assets/avatar/${t&&t.media}`],import.meta.url).href,W=g.split("/").length,B=g.split("/")[W-1];B!=="undefined"&&p(g),B=="undefined"&&p(null)}u()},[l,t]),o.useEffect(()=>{async function u(){const h=`https://saeedwebdev.ir/api/likes/${b[0]&&b[0].id}=${t.id}`,x=b[0]&&await I(h);x&&(y(x.isMyLike),v(x.quantity))}u()},[b[0]]),o.useEffect(()=>{async function u(){const h=`https://saeedwebdev.ir/api/comments/q/${t.id}`,x=await D(h);x&&N(x),x==0&&N(0)}u()},[t]);const z=()=>{async function u(){await ce(`https://saeedwebdev.ir/api/posts/${t.id}`)&&O(oe(t))}l&&b[0]&&l.id==b[0].id?u():r(!n)},H=()=>{const u="https://saeedwebdev.ir/api/likes",h=`https://saeedwebdev.ir/api/likes/${b[0].id}=${t.id}`;async function x(){if(await pe(u,t.id,b[0].id)){const g=await I(h);y(g.isMyLike),v(g.quantity)}}x()},q=()=>{const u=`https://saeedwebdev.ir/api/likes/${b[0].id}=${t.id}`,h=`https://saeedwebdev.ir/api/likes/${b[0].id}=${t.id}`;async function x(){if(await je(u)){const g=await I(h);y(g.isMyLike),v(g.quantity)}}x()},Q=()=>{C(!0)},T=()=>{C(!1)},V=()=>{r(!1)};return e.jsxs("div",{className:"relative flex justify-center w-full",children:[e.jsxs("div",{className:`flex flex-col  w-full ${s?"":"md:rounded-[.6rem] rounded-[.3rem] shadow-3xl"} max-w-[800px] bg-white`,children:[s!=="comment"&&e.jsxs("header",{className:"flex justify-between md:pt-3 pt-2 md:px-4 px-2 h-[48px] md:mb-3 mb-1 gap-3",children:[e.jsxs("a",{href:`/sma/profile/${l&&l.id}`,className:"flex w-full md:gap-3 gap-2 cursor-pointer",children:[e.jsx("div",{className:"w-10 h-10 min-w-[40px]",children:e.jsx("img",{src:d||_,alt:"profile picture",className:"object-cover h-full w-full rounded-full"})}),e.jsxs("div",{className:"relative h-9 w-full md:mt-0 mt-1 md:text-[1rem] text-[.9rem]",children:[e.jsx("span",{className:"absolute flex h-4 -top-1",children:l&&l.firstName+" "+l.lastName}),e.jsx("div",{className:"absolute flex h-4 top-5 gap-1",children:e.jsxs("small",{children:["@",l&&l.username]})})]})]}),e.jsxs("div",{className:"flex",children:[e.jsx("button",{className:"flex items-center justify-center md:text-2xl text-[1.7rem] min-w-[40px] min-h-[40px] rounded-full hover:bg-bg-hover",children:e.jsx(le,{})}),e.jsxs("button",{onClick:z,className:"relative flex items-center justify-center font-normal min-w-[40px] min-h-[40px] rounded-full hover:bg-bg-hover",children:[e.jsx("i",{className:"absolute w-[.1rem] md:h-5 h-5 rotate-45 bg-black"}),e.jsx("i",{className:"absolute md:w-5 w-5 h-[.1rem] rotate-45 bg-black"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 max-h-min",children:[e.jsx("div",{className:"md:px-4 px-2 md:text-[1rem] text-[.9rem]",children:e.jsx("p",{children:t.text})}),e.jsx("div",{className:"flex justify-center w-full",children:e.jsx("img",{src:i,alt:""})})]}),e.jsxs("footer",{className:"flex flex-col md:px-4 px-2",children:[e.jsxs("div",{className:"flex items-center justify-between w-full py-2 border-b-[2px]",children:[e.jsxs("div",{className:"flex gap-1 md:mt-0 mt-1 md:text-[1rem] text-[.9rem]",children:[e.jsx("span",{children:"نظرات"}),e.jsx("span",{children:F&&F})]}),e.jsxs("button",{onClick:w&&w==1?q:H,className:"relative flex",children:[e.jsx("span",{className:"md:pl-12 pl-11",children:S&&S}),e.jsx("i",{className:"absolute left-5 md:top-0 top-[.1rem] flex items-center justify-center md:text-[.8rem] text-[.7rem] bg-red-400 [&>*]:text-white p-1 rounded-full border-2 border-white",children:e.jsx(ae,{})}),e.jsx("i",{className:"absolute left-0 md:top-0 top-[.1rem] flex items-center justify-center md:text-[.8rem] text-[.7rem] bg-blue-400 text-white p-1 rounded-full border-2 border-white",children:e.jsx(ne,{})})]})]}),e.jsxs("div",{className:"flex items-center justify-between w-full md:min-h-[44px] min-h-[34px] py-[.25rem]",children:[e.jsxs("button",{className:"flex items-center justify-center w-full h-full md:gap-2 gap-1 hover:bg-bg-hover rounded-[.3rem]",children:[e.jsx("i",{className:"md:text-2xl",children:e.jsx(ie,{})}),e.jsx("span",{className:"md:text-[1rem] text-[.8rem]",children:"دوست داشتن"})]}),e.jsxs("button",{onClick:s!=="comment"?Q:a,className:"flex items-center justify-center w-full h-full md:gap-2 gap-1 hover:bg-bg-hover rounded-[.3rem]",children:[e.jsx("i",{className:"md:text-2xl",children:e.jsx(xe,{})}),e.jsx("span",{className:"md:text-[1rem] text-[.8rem]",children:"نظرات"})]}),e.jsxs("button",{onClick:()=>f(!m),className:"relative flex items-center justify-center w-full h-full md:gap-2 gap-1 hover:bg-bg-hover rounded-[.3rem]",children:[e.jsx("i",{className:"md:text-2xl",children:e.jsx(re,{})}),e.jsx("span",{className:"md:text-[1rem] text-[.8rem]",children:"ارسال"}),m&&e.jsx(ye,{})]})]})]})]}),n&&e.jsx(ke,{handleNotIntrest:V}),j&&s!=="comment"&&e.jsx(Ne,{post:t,handleSetComment:T,targetUser:l})]})},Pe=({targetUser:t})=>{const[s,a]=o.useState("دنبال کردن"),i=k(c=>c.ui).loginUser;o.useEffect(()=>{const c=t[0]&&i[0]&&`https://saeedwebdev.ir/api/friends/f/${i[0].id}=${t[0].id}`;async function n(){const r=t[0]&&i[0]&&await de(c);r[0]&&r[0].friend_id==t[0].id&&a("دنبال شده")}n()},[]);const p=()=>{const c="https://saeedwebdev.ir/api/friends",n=i[0]&&i[0].id,r=t[0]&&t[0].id;async function m(){(await me(c,n,r))[0]&&a("دنبال شده")}m()},d=()=>{const c=`https://saeedwebdev.ir/api/friends/${t[0]&&t[0].id}`;async function n(){await ue(c)&&a("دنبال کردن")}n()};return e.jsx("button",{onClick:s=="دنبال کردن"?p:d,className:"flex items-center justify-center min-w-max font-medium md:px-2 px-[.4rem] pt-1 pb-2 md:text-[.8rem] text-[.8rem] rounded-[.4rem] cursor-pointer bg-green-500 hover:bg-green-600 text-white",children:s})};export{Pe as F,$e as P,Ce as a};
